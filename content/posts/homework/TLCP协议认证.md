---

title: TLCP协议认证
subtitle:
date: 2024-11-02T10:11:56+08:00
draft: false
author:
  name: 瞻鹤
  link:
  email: he-zhan@outlook.com
  avatar: /images/avatar.jpg
description:
keywords:
license:
comment: false
weight: 0
tags:
  - 
categories:
  - homework
hiddenFromHomePage: false
hiddenFromSearch: false
hiddenFromRss: false
hiddenFromRelated: false
summary:
resources:
  - name: featured-image
    src: featured-image.jpg
  - name: featured-image-preview
    src: featured-image-preview.jpg
toc: true
math: false
lightgallery: false
password:
message:
repost:
  enable: true
  url:

# See details front matter: https://fixit.lruihao.cn/documentation/content-management/introduction/#front-matter
---

<!--more-->	

## 参考云班课课程资源中“ch03 密码技术-协议验证”的“VPN协议验证.pdf”和“ch03 密码技术-09-密码协议验证TLCP.mp4”，对 TLCP 协议进行验证，提交验证过程。（79分）

### 服务端密钥交换消息（Server Key Exchange）验证

客户端随机数

~~~ bash
6541f880b28ee1eaea9d5a92679ce16cea85c56df7ede810ffa78d44fb0b944d
~~~

服务器随机数

~~~ bash
553c83b288b79abae1841fe1e05ff29d0771d3160314d562444f574e47524400
~~~

签名
~~~ bash
308201f330820198a00302010202145326ccffbb03ba78b831599da3e085133de83da8300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f7365727665725f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000499fe11af63e5cc352759771030cf5ab549f4f2ee3ccd8126345d81d0116aa15087977e9303701cc565ecae91441b670af288eade4c579ef817f2ad65d054fda2a31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750349003046022100fb2cfe11bdacf92a9f2b10bfdb9e6d7fff08e8683ee63b440b25c5c6836f85c5022100b66a71e1236de75383976a5e8d38f06f0db145ae01ea8313231edfe35f215639
~~~

签名原文

~~~ bash
6541f880b28ee1eaea9d5a92679ce16cea85c56df7ede810ffa78d44fb0b944d553c83b288b79abae1841fe1e05ff29d0771d3160314d562444f574e475244000001f7308201f330820198a00302010202145326ccffbb03ba78b831599da3e085133de83da8300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f7365727665725f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000499fe11af63e5cc352759771030cf5ab549f4f2ee3ccd8126345d81d0116aa15087977e9303701cc565ecae91441b670af288eade4c579ef817f2ad65d054fda2a31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750349003046022100fb2cfe11bdacf92a9f2b10bfdb9e6d7fff08e8683ee63b440b25c5c6836f85c5022100b66a71e1236de75383976a5e8d38f06f0db145ae01ea8313231edfe35f215639
~~~

签名值

~~~ bash
3045022100b2e2c924d43aaa5ae11492e34b0c3cb1cfbd4c1742b3eead44a89e7129427a060220652a4550b0bd8f1594c5bc7c8f370539fe6a57d5e1a17e78ff99e0566a1a4a20

30 T
46 L
02 T
21 L
00 补充数据：采⽤⼆进制补码编码，下个字节d1最⾼位为1，为了防⽌认为是负数，补00
d111933a5d9b42e7010e8787dcc6c28eda4e853fde9b0a27f8aa5937d091afdc V：签名值r
02 T
21 L
00 V
8dd88b5116738935cefad8b5cd7a5f7b554ba92cd20d22e722a055f4fc2e4d61 V：签名值s
实际签名值
d111933a5d9b42e7010e8787dcc6c28eda4e853fde9b0a27f8aa5937d091afdc8dd88b5116738935cefad8b5cd7a5f7b554ba92cd20d22e722a055f4fc2e4d61
~~~

server签名公钥

~~~ bash
049cd6f179df6a5fd2b71f2a772764b4fc54681c8444285421bdcdf81eee4baa3d95e50b04a59221118da1e0aac92572bea750db3d7eae9765ebfda7110fc4e7d7
~~~

实际公钥

~~~ bash
9cd6f179df6a5fd2b71f2a772764b4fc54681c8444285421bdcdf81eee4baa3d95e50b04a59221118da1e0aac92572bea750db3d7eae9765ebfda7110fc4e7d7
~~~

验签

![image-20241102103757301](TLCP协议认证.assets/image-20241102103757301.png)

### 客户端证书和密钥交换验证

client hello

~~~ bash
0100003c01016541f880b28ee1eaea9d5a92679ce16cea85c56df7ede810ffa78d44fb0b944d00000ae013e011e003e00100ff0100000900230000000f000101
~~~

server hello

~~~ bash
0200004d0101553c83b288b79abae1841fe1e05ff29d0771d3160314d562444f574e4752440020f9fd8a5e100eb5f3fb89e091370a8ec0f2a660348bfa82387d9c25c21b6c24f3e013000005ff01000100
~~~

双证书

~~~ bash
0b0003f20003ef0001f2308201ee30820194a00302010202145326ccffbb03ba78b831599da3e085133de83da7300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306a310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3113301106035504030c0a736d325f7365727665723059301306072a8648ce3d020106082a811ccf5501822d034200049cd6f179df6a5fd2b71f2a772764b4fc54681c8444285421bdcdf81eee4baa3d95e50b04a59221118da1e0aac92572bea750db3d7eae9765ebfda7110fc4e7d7a31a301830090603551d1304023000300b0603551d0f0404030205e0300a06082a811ccf550183750348003045022100dd112f544c8699205fb12e35a07065fb916d6e95445f8870de27ad1467aeabf402201b02357965886bdbcf2407ad1c42bc8d4fe9d686c064aea52dc31f1ca931736b0001f7308201f330820198a00302010202145326ccffbb03ba78b831599da3e085133de83da8300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f7365727665725f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000499fe11af63e5cc352759771030cf5ab549f4f2ee3ccd8126345d81d0116aa15087977e9303701cc565ecae91441b670af288eade4c579ef817f2ad65d054fda2a31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750349003046022100fb2cfe11bdacf92a9f2b10bfdb9e6d7fff08e8683ee63b440b25c5c6836f85c5022100b66a71e1236de75383976a5e8d38f06f0db145ae01ea8313231edfe35f215639
~~~

~~~ bash
0b0003f20003ef0001f2
30 T
8201ee L
30820194a00302010202145326ccffbb03ba78b831599da3e085133de83da7300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306a310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3113301106035504030c0a736d325f7365727665723059301306072a8648ce3d020106082a811ccf5501822d034200049cd6f179df6a5fd2b71f2a772764b4fc54681c8444285421bdcdf81eee4baa3d95e50b04a59221118da1e0aac92572bea750db3d7eae9765ebfda7110fc4e7d7a31a301830090603551d1304023000300b0603551d0f0404030205e0300a06082a811ccf550183750348003045022100dd112f544c8699205fb12e35a07065fb916d6e95445f8870de27ad1467aeabf402201b02357965886bdbcf2407ad1c42bc8d4fe9d686c064aea52dc31f1ca931736b0001f7308201f330820198a00302010202145326ccffbb03ba78b831599da3e085133de83da8300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f7365727665725f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000499fe11af63e5cc352759771030cf5ab549f4f2ee3ccd8126345d81d0116aa15087977e9303701cc565ecae91441b670af288eade4c579ef817f2ad65d054fda2a31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750349003046022100fb2cfe11bdacf92a9f2b10bfdb9e6d7fff08e8683ee63b440b25c5c6836f85c5022100b66a71e1236de75383976a5e8d38f06f0db145ae01ea8313231edfe35f215639
~~~

server key exchange

~~~ bash
0c00004a00483046022100d111933a5d9b42e7010e8787dcc6c28eda4e853fde9b0a27f8aa5937d091afdc0221008dd88b5116738935cefad8b5cd7a5f7b554ba92cd20d22e722a055f4fc2e4d61
~~~

certificate request

~~~ bash
0d0000050201020000
~~~

server hello done

~~~ bash
0e000000
~~~

client 证书

~~~ bash
0b0003f10003ee0001f2
30 T
8201ee L
30820194a00302010202145326ccffbb03ba78b831599da3e085133de83da5300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306a310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3113301106035504030c0a736d325f636c69656e743059301306072a8648ce3d020106082a811ccf5501822d03420004f1351cf6292f6f4ca4a4b727d81a3285826ce231c169bbb301b552991de5d016fe552ec26aef8260ca85f2007b9ab836be6a61edf3d9c8567dcce1d1394dcfa9a31a301830090603551d1304023000300b0603551d0f0404030205e0300a06082a811ccf550183750348003045022100b8b4f96c8644b8c8ebae6cd333ecc5df783ed7419bf46ad92e51e7257d25670b0220294db4ed04feebeec47f95048c4d2c13781f1ac930e3756a6d8076ffc1352ec80001f6308201f230820198a00302010202145326ccffbb03ba78b831599da3e085133de83da6300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f636c69656e745f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000449bb9eefc8831883173196e6c9de37fefc24251429f3bd5950a11f60fbf016b573bbece3ce92c624b21cb570fb55fe5b1c1e74ccebe871ff7d4503128da4ef7ea31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750348003045022100ddef0028f0e53dd09b7d32b93426045def0b7524725ce025958c96e9a617a167022015e30a9269fa4eecef991a1935837abfe47a6970f95829ad9cc518133997d83c
~~~

client key exchange

~~~ bash
1000009e009c30819902210082726f634e53e6c54884ef29ae668e6dd54ee9e32e7aafe5b2fb15ddf5aadd4502206f3b2e27716ea92f4d68b48de9645dc949bfa5da757a0b15f42262ef17c085b30420af9da5257ed27b586587425dc755b7886bdf55d0866da22f56c17d8e7f146874043007194ce4335592c2a674ce3f15914a2ea04f5c64ddf25b796a4cb7df1278b413e31c0266255463b741dddf834188195a
~~~

使⽤⼯具计算签名数据 sm3 hash(client hello||server hello||server 证书||server key exchange||server certificate request||server hello done ||client 证书||client key exchange)

~~~ bash
0100003c01016541f880b28ee1eaea9d5a92679ce16cea85c56df7ede810ffa78d44fb0b944d00000ae013e011e003e00100ff0100000900230000000f0001010200004d0101553c83b288b79abae1841fe1e05ff29d0771d3160314d562444f574e4752440020f9fd8a5e100eb5f3fb89e091370a8ec0f2a660348bfa82387d9c25c21b6c24f3e013000005ff010001000b0003f20003ef0001f2308201ee30820194a00302010202145326ccffbb03ba78b831599da3e085133de83da7300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306a310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3113301106035504030c0a736d325f7365727665723059301306072a8648ce3d020106082a811ccf5501822d034200049cd6f179df6a5fd2b71f2a772764b4fc54681c8444285421bdcdf81eee4baa3d95e50b04a59221118da1e0aac92572bea750db3d7eae9765ebfda7110fc4e7d7a31a301830090603551d1304023000300b0603551d0f0404030205e0300a06082a811ccf550183750348003045022100dd112f544c8699205fb12e35a07065fb916d6e95445f8870de27ad1467aeabf402201b02357965886bdbcf2407ad1c42bc8d4fe9d686c064aea52dc31f1ca931736b0001f7308201f330820198a00302010202145326ccffbb03ba78b831599da3e085133de83da8300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f7365727665725f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000499fe11af63e5cc352759771030cf5ab549f4f2ee3ccd8126345d81d0116aa15087977e9303701cc565ecae91441b670af288eade4c579ef817f2ad65d054fda2a31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750349003046022100fb2cfe11bdacf92a9f2b10bfdb9e6d7fff08e8683ee63b440b25c5c6836f85c5022100b66a71e1236de75383976a5e8d38f06f0db145ae01ea8313231edfe35f2156390c00004a00483046022100d111933a5d9b42e7010e8787dcc6c28eda4e853fde9b0a27f8aa5937d091afdc0221008dd88b5116738935cefad8b5cd7a5f7b554ba92cd20d22e722a055f4fc2e4d610d00000502010200000e0000000b0003f10003ee0001f2308201ee30820194a00302010202145326ccffbb03ba78b831599da3e085133de83da5300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306a310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3113301106035504030c0a736d325f636c69656e743059301306072a8648ce3d020106082a811ccf5501822d03420004f1351cf6292f6f4ca4a4b727d81a3285826ce231c169bbb301b552991de5d016fe552ec26aef8260ca85f2007b9ab836be6a61edf3d9c8567dcce1d1394dcfa9a31a301830090603551d1304023000300b0603551d0f0404030205e0300a06082a811ccf550183750348003045022100b8b4f96c8644b8c8ebae6cd333ecc5df783ed7419bf46ad92e51e7257d25670b0220294db4ed04feebeec47f95048c4d2c13781f1ac930e3756a6d8076ffc1352ec80001f6308201f230820198a00302010202145326ccffbb03ba78b831599da3e085133de83da6300a06082a811ccf550183753068310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3111300f06035504030c08736d325f726f6f74301e170d3230303730323036303030355a170d3330303633303036303030355a306e310b300906035504061302434e3111300f06035504080c085368616e646f6e67310f300d060355040a0c0653616e7365633122302006092a864886f70d01090116136e656967686261647340676d61696c2e636f6d3117301506035504030c0e736d325f636c69656e745f656e633059301306072a8648ce3d020106082a811ccf5501822d0342000449bb9eefc8831883173196e6c9de37fefc24251429f3bd5950a11f60fbf016b573bbece3ce92c624b21cb570fb55fe5b1c1e74ccebe871ff7d4503128da4ef7ea31a301830090603551d1304023000300b0603551d0f040403020470300a06082a811ccf550183750348003045022100ddef0028f0e53dd09b7d32b93426045def0b7524725ce025958c96e9a617a167022015e30a9269fa4eecef991a1935837abfe47a6970f95829ad9cc518133997d83c1000009e009c30819902210082726f634e53e6c54884ef29ae668e6dd54ee9e32e7aafe5b2fb15ddf5aadd4502206f3b2e27716ea92f4d68b48de9645dc949bfa5da757a0b15f42262ef17c085b30420af9da5257ed27b586587425dc755b7886bdf55d0866da22f56c17d8e7f146874043007194ce4335592c2a674ce3f15914a2ea04f5c64ddf25b796a4cb7df1278b413e31c0266255463b741dddf834188195a
~~~
SM3哈希结果
~~~ bash
c08d85599e2172797add1a3d510b63f3122815b9716e426facd0ca83a36c60cf
~~~

签名值

~~~ bash
3045022100b2e2c924d43aaa5ae11492e34b0c3cb1cfbd4c1742b3eead44a89e7129427a060220652a4550b0bd8f1594c5bc7c8f370539fe6a57d5e1a17e78ff99e0566a1a4a20

30 T
45 L
022100
b2e2c924d43aaa5ae11492e34b0c3cb1cfbd4c1742b3eead44a89e7129427a06 r
0220
652a4550b0bd8f1594c5bc7c8f370539fe6a57d5e1a17e78ff99e0566a1a4a20 s
实际签名
b2e2c924d43aaa5ae11492e34b0c3cb1cfbd4c1742b3eead44a89e7129427a06652a4550b0bd8f1594c5bc7c8f370539fe6a57d5e1a17e78ff99e0566a1a4a20
~~~

客户端签名公钥

~~~ bash
f1351cf6292f6f4ca4a4b727d81a3285826ce231c169bbb301b552991de5d016fe552ec26aef8260ca85f2007b9ab836be6a61edf3d9c8567dcce1d1394dcfa9
~~~

![image-20241102110300312](TLCP协议认证.assets/image-20241102110300312.png)

### 密钥计算

~~~ bash
-----BEGIN PRIVATE KEY-----
MIGTAgEAMBMGByqGSM49AgEGCCqBHM9VAYItBHkwdwIBAQQgb8tUl8wJ17FqiOSp
pHwKa1pOgxQhAP0VoPe/EU0cGAqgCgYIKoEcz1UBgi2hRANCAARipb11eBDLluL8
OMWZOfdyOXKsvWMu40pEW2nFdUPxWpRw+akHNz8Aat6Mbr5k9fUiG3gbC/SYG44t
d40YCWFb
-----END PRIVATE KEY-----
解析得到：
私钥：
6fcb5497cc09d7b16a88e4a9a47c0a6b5a4e83142100fd15a0f7bf114d1c180a
公钥：
62a5bd757810cb96e2fc38c59939f7723972acbd632ee34a445b69c57543f15a9470f9a907373f006ade8c6ebe64f5f5221b781b0bf4981b8e2d778d1809615b
~~~

#### 预主密钥

~~~ bash
30819802202f1233582f931890b0d6472d39c1729cc20e00d9b26a0ad119c468b8bbbb3e1a0220171274bf57ef071e4d76ee3441f39b31996b2438e5f3334f91533e93aa1c3db90420a1e8b8721d5f922c6e33fb7052a2afb0038d05017e2c0ab5035bf772da2cc2f30430c2ce0c6634f3d7626db03963d8c19d8a98c1c4756659b707547fdf0439505e4c1bca72406c22d6ee62e1811d016b402e
~~~

~~~ shell
30 T
8198 L
02 T
20 L
2f1233582f931890b0d6472d39c1729cc20e00d9b26a0ad119c468b8bbbb3e1a X
02 T
20 L
171274bf57ef071e4d76ee3441f39b31996b2438e5f3334f91533e93aa1c3db9 Y
04 T
20 L
a1e8b8721d5f922c6e33fb7052a2afb0038d05017e2c0ab5035bf772da2cc2f3 Hash
04
30
c2ce0c6634f3d7626db03963d8c19d8a98c1c4756659b707547fdf0439505e4c1bca72406c22d6ee62e1811d016b402e 密⽂
~~~

预主密钥值为

~~~ bash
2f1233582f931890b0d6472d39c1729cc20e00d9b26a0ad119c468b8bbbb3e1a171274bf57ef071e4d76ee3441f39b31996b2438e5f3334f91533e93aa1c3db9a1e8b8721d5f922c6e33fb7052a2afb0038d05017e2c0ab5035bf772da2cc2f3c2ce0c6634f3d7626db03963d8c19d8a98c1c4756659b707547fdf0439505e4c1bca72406c22d6ee62e1811d016b402e
~~~

使用私钥解密得到预主密钥明文为：

~~~ 
0101ac14a3d2da7dccfcaa9fee0882f41b9974aa17b8a3070c042df50a275caaec6ed730dfd132ea871bdd19574dc83f
~~~
没有上传时：Applicate Data为密⽂
~~~
fc5cd01c24a9f63290941ac015b49a6f9fd9ca2f9a2c9bc8d08f2d6fd41cb0e07fb573219ae693175a01279175cfd6efed1c0697a638a8c5cac3ee3e531d99cc
~~~

文件内容

~~~
PMS_CLIENT_RANDOM 0a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d8 0101ac14a3d2da7dccfcaa9fee0882f41b9974aa17b8a3070c042df50a275caaec6ed730dfd132ea871bdd19574dc83f
~~~

明文

~~~ 
4554202f20485454502f312e310d0a486f73743a206c6f63616c686f73740d0a436f6e6e656374696f6e3a20636c6f73650d0a0d0a
~~~

#### 计算主密钥

字符串“master secret”的ASCII码

~~~
6d617374657220736563726574
~~~

ClientHello.random

~~~
0a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d8
~~~

ServerHello.random

~~~
5423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac268
~~~

A0(seed)为 "字符串"master secret"的ASCII码｜｜ClientHello.random｜｜ServerHello.random"

~~~
6d6173746572207365637265740a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d85423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac268
~~~

使用预主密钥明文对A0进行HMAC加密

得到A1

~~~
75466ba297baa6abf75fa19698b5debdf815d632b98fdaf7c1bf60d8a7724f9e
~~~

同理对A1进行HMAC计算得到A2

~~~
c7642fabae939cad31063af385648bb48b8fb31e4c94ed97e1cc271208c0e477
~~~

A1||seed

~~~
75466ba297baa6abf75fa19698b5debdf815d632b98fdaf7c1bf60d8a7724f9e6d6173746572207365637265740a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d85423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac268
~~~

ms1

~~~
640da76978a5efd6e0953088f015fa20ee810e48e24aa6f19a8900bcff05a3a7
~~~

A2||seed

~~~
c7642fabae939cad31063af385648bb48b8fb31e4c94ed97e1cc271208c0e4776d6173746572207365637265740a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d85423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac268
~~~

ms2

~~~
722de36c807e5c7ca912e7e6ffa4965e7db07bef99df8c0f27f29c21237f94c7
~~~

ms1||ms2

~~~
640da76978a5efd6e0953088f015fa20ee810e48e24aa6f19a8900bcff05a3a7722de36c807e5c7ca912e7e6ffa4965e
~~~

#### 计算⼯作密钥

得到⾃字符串“key expansion”的ASCII码：

~~~
6b657920657870616e73696f6e
~~~

server_random

~~~
5423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac268
~~~

client_random

~~~
0a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d8
~~~

A0(seed)

~~~
6b657920657870616e73696f6e5423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac2680a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d8
~~~

A1=HMAC(MS, A0),kb1=HMAC(MS, A1||seed)

A1

~~~
6003a5937faa6c9276656bd9cf11e5fc44d1da8cf8916cc3f1a1d9c9c5b2c364
~~~

A1||seed

~~~
6003a5937faa6c9276656bd9cf11e5fc44d1da8cf8916cc3f1a1d9c9c5b2c3646b657920657870616e73696f6e5423003bf0b79c2a134837d6c560dfb6d11cebdb2ab84e701fafe387b31ac2680a359775d8a2c2fd2756261b8ae86767db7b3cd3be532c9665ea432dc260b6d8
~~~

kb1

~~~
87e00935dc21b9d87e3e5616179307d817966079a0dea9b9d09a4883cbf0e13d
~~~

A2=HMAC(MS, A1),kb2=HMAC(MS, A2||seed)

A2

~~~
0a45328c9d23a88ad0b0dfe3656996b979bd4a2730a3f8ede29bc392153b6a6b
~~~

kb2

~~~
b4b53c3b2acafe5781712816c1a3a2cece09d5837eb3389bdf1e471b06bc8157
~~~

A3=HMAC(MS, A2),kb3=HMAC(MS, A3||seed)

A3

~~~
fee4db5e22a5e48c3c0e0b88509763940a8e65c4aaf850c00ae7eb72282089cf
~~~

kb3

~~~
022a23065301de9e49aaa0879e4ecbf2622cda5b8994a0bb4496f03b8c13a4cd
~~~

A4=HMAC(MS, A3),kb4=HMAC(MS, A4||seed)

A4

~~~
8807466c968862f58c17b171b3520ab2a519d5df00c8fc991e9d696244c95437
~~~

kb4

~~~
145ba093616e5939aae6b59e4bed770145482c297f4c7cc76b497fcb1b2f4a84
~~~

工作密钥kb1||kb2||kb3||kb4

~~~
87e00935dc21b9d87e3e5616179307d817966079a0dea9b9d09a4883cbf0e13db4b53c3b2acafe5781712816c1a3a2cece09d5837eb3389bdf1e471b06bc8157022a23065301de9e49aaa0879e4ecbf2622cda5b8994a0bb4496f03b8c13a4cd145ba093616e5939aae6b59e4bed770145482c297f4c7cc76b497fcb1b2f4a84
~~~

MAC 256bits, key 128bits, IV 128bits, 分解得到：

~~~
client MAC 87e00935dc21b9d87e3e5616179307d817966079a0dea9b9d09a4883cbf0e13d
server MAC b4b53c3b2acafe5781712816c1a3a2cece09d5837eb3389bdf1e471b06bc8157
client write key 022a23065301de9e49aaa0879e4ecbf2
server write key 622cda5b8994a0bb4496f03b8c13a4cd
client IV 145ba093616e5939aae6b59e4bed7701
server IV 45482c297f4c7cc76b497fcb1b2f4a84
~~~

## 不使用 “VPN协议验证.pdf”中的商用密码工具，使用 OpenSSL或者 GmSSL命令进行验证，提交验证过程（选做,加分项目，加20分）

### 服务端密钥交换消息（Server Key Exchange）验证

~~~
echo -e -n "\x65\x41\xf8\x80\xb2\x8e\xe1\xea\xea\x9d\x5a\x92\x67\x9c\xe1\x6c\xea\x85\xc5\x6d\xf7\xed\xe8\x10\xff\xa7\x8d\x44\xfb\x0b\x94\x4d\x55\x3c\x83\xb2\x88\xb7\x9a\xba\xe1\x84\x1f\xe1\xe0\x5f\xf2\x9d\x07\x71\xd3\x16\x03\x14\xd5\x62\x44\x4f\x57\x4e\x47\x52\x44\x00\x00\x01\xf7\x30\x82\x01\xf3\x30\x82\x01\x98\xa0\x03\x02\x01\x02\x02\x14\x53\x26\xcc\xff\xbb\x03\xba\x78\xb8\x31\x59\x9d\xa3\xe0\x85\x13\x3d\xe8\x3d\xa8\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x30\x68\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x11\x30\x0f\x06\x03\x55\x04\x03\x0c\x08\x73\x6d\x32\x5f\x72\x6f\x6f\x74\x30\x1e\x17\x0d\x32\x30\x30\x37\x30\x32\x30\x36\x30\x30\x30\x35\x5a\x17\x0d\x33\x30\x30\x36\x33\x30\x30\x36\x30\x30\x30\x35\x5a\x30\x6e\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x17\x30\x15\x06\x03\x55\x04\x03\x0c\x0e\x73\x6d\x32\x5f\x73\x65\x72\x76\x65\x72\x5f\x65\x6e\x63\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x08\x2a\x81\x1c\xcf\x55\x01\x82\x2d\x03\x42\x00\x04\x99\xfe\x11\xaf\x63\xe5\xcc\x35\x27\x59\x77\x10\x30\xcf\x5a\xb5\x49\xf4\xf2\xee\x3c\xcd\x81\x26\x34\x5d\x81\xd0\x11\x6a\xa1\x50\x87\x97\x7e\x93\x03\x70\x1c\xc5\x65\xec\xae\x91\x44\x1b\x67\x0a\xf2\x88\xea\xde\x4c\x57\x9e\xf8\x17\xf2\xad\x65\xd0\x54\xfd\xa2\xa3\x1a\x30\x18\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04\x04\x03\x02\x04\x70\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x03\x49\x00\x30\x46\x02\x21\x00\xfb\x2c\xfe\x11\xbd\xac\xf9\x2a\x9f\x2b\x10\xbf\xdb\x9e\x6d\x7f\xff\x08\xe8\x68\x3e\xe6\x3b\x44\x0b\x25\xc5\xc6\x83\x6f\x85\xc5\x02\x21\x00\xb6\x6a\x71\xe1\x23\x6d\xe7\x53\x83\x97\x6a\x5e\x8d\x38\xf0\x6f\x0d\xb1\x45\xae\x01\xea\x83\x13\x23\x1e\xdf\xe3\x5f\x21\x56\x39" > in.txt
~~~

~~~
echo -e -n "\x30\x46\x02\x21\x00\xd1\x11\x93\x3a\x5d\x9b\x42\xe7\x01\x0e\x87\x87\xdc\xc6\xc2\x8e\xda\x4e\x85\x3f\xde\x9b\x0a\x27\xf8\xaa\x59\x37\xd0\x91\xaf\xdc\x02\x21\x00\x8d\xd8\x8b\x51\x16\x73\x89\x35\xce\xfa\xd8\xb5\xcd\x7a\x5f\x7b\x55\x4b\xa9\x2c\xd2\x0d\x22\xe7\x22\xa0\x55\xf4\xfc\x2e\x4d\x61" > sm2.sig
~~~

~~~ 
9cd6f179df6a5fd2b71f2a772764b4fc54681c8444285421bdcdf81eee4baa3d95e50b04a59221118da1e0aac92572bea750db3d7eae9765ebfda7110fc4e7d7
`pem`格式下的密钥是`ASN.1`编码后再经过`Base64`编码的结果。首先按照`ASN.1`编码的格式，得出密钥对应数据如下：
3059301306072A8648CE3D020106082A811CCF5501822D034200049CD6F179DF6A5FD2B71F2A772764B4FC54681C8444285421BDCDF81EEE4BAA3D95E50B04A59221118DA1E0AAC92572BEA750DB3D7EAE9765EBFDA7110FC4E7D7

30 表示这是一个SEQUENCE
59 这个SEQUENCE接下来的长度为0x59
30 表示这是一个SEQUENCE。这个SEQUENCE是总SEQUENCE的一部分
13 当前这个SEQUENCE的长度为0x13
06 表示OID的开始
07 OID的长度是0x07
2A 86 48 CE 3D 02 01 这个OID是1.2.840.10045.4.3.3，代表椭圆曲线公钥算法ecdsa-with-SHA2
06 表示另一个OID的开始
08 OID的长度是0x08
2A 81 1C CF 55 01 82 2D 这个OID是1.2.156.10197.1.301，表示公钥参数
03 表示后面是BIT STRING。
42 BIT STRING的长度是0x42。
00 编码数据的比特位对8取模的余数
04 9C D6 F1 79 DF 6A 5F D2 B7 1F 2A 77 27 64 B4 FC 54 68 1C 84 44 28 54 21 BD CD F8 1E EE 4B AA 3D 95 E5 0B 04 A5 92 21 11 8D A1 E0 AA C9 25 72 BE A7 50 DB 3D 7E AE 97 65 EB FD A7 11 0F C4 E7 D7 公钥数据

进行base64编码得到:
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEnNbxed9qX9K3Hyp3J2S0/FRoHIRE
KFQhvc34Hu5Lqj2V5QsEpZIhEY2h4KrJJXK+p1DbPX6ul2Xr/acRD8Tn1w==
-----END PUBLIC KEY-----
~~~

#### 验证

~~~ shell
$ gmssl sm2verify -pubkey pub.pem -sig sm2.sig -in in.txt
verify : success
~~~

### 客户端证书和密钥交换验证

~~~ shell
$ echo -e -n "\x01\x00\x00\x3c\x01\x01\x65\x41\xf8\x80\xb2\x8e\xe1\xea\xea\x9d\x5a\x92\x67\x9c\xe1\x6c\xea\x85\xc5\x6d\xf7\xed\xe8\x10\xff\xa7\x8d\x44\xfb\x0b\x94\x4d\x00\x00\x0a\xe0\x13\xe0\x11\xe0\x03\xe0\x01\x00\xff\x01\x00\x00\x09\x00\x23\x00\x00\x00\x0f\x00\x01\x01\x02\x00\x00\x4d\x01\x01\x55\x3c\x83\xb2\x88\xb7\x9a\xba\xe1\x84\x1f\xe1\xe0\x5f\xf2\x9d\x07\x71\xd3\x16\x03\x14\xd5\x62\x44\x4f\x57\x4e\x47\x52\x44\x00\x20\xf9\xfd\x8a\x5e\x10\x0e\xb5\xf3\xfb\x89\xe0\x91\x37\x0a\x8e\xc0\xf2\xa6\x60\x34\x8b\xfa\x82\x38\x7d\x9c\x25\xc2\x1b\x6c\x24\xf3\xe0\x13\x00\x00\x05\xff\x01\x00\x01\x00\x0b\x00\x03\xf2\x00\x03\xef\x00\x01\xf2\x30\x82\x01\xee\x30\x82\x01\x94\xa0\x03\x02\x01\x02\x02\x14\x53\x26\xcc\xff\xbb\x03\xba\x78\xb8\x31\x59\x9d\xa3\xe0\x85\x13\x3d\xe8\x3d\xa7\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x30\x68\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x11\x30\x0f\x06\x03\x55\x04\x03\x0c\x08\x73\x6d\x32\x5f\x72\x6f\x6f\x74\x30\x1e\x17\x0d\x32\x30\x30\x37\x30\x32\x30\x36\x30\x30\x30\x35\x5a\x17\x0d\x33\x30\x30\x36\x33\x30\x30\x36\x30\x30\x30\x35\x5a\x30\x6a\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x13\x30\x11\x06\x03\x55\x04\x03\x0c\x0a\x73\x6d\x32\x5f\x73\x65\x72\x76\x65\x72\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x08\x2a\x81\x1c\xcf\x55\x01\x82\x2d\x03\x42\x00\x04\x9c\xd6\xf1\x79\xdf\x6a\x5f\xd2\xb7\x1f\x2a\x77\x27\x64\xb4\xfc\x54\x68\x1c\x84\x44\x28\x54\x21\xbd\xcd\xf8\x1e\xee\x4b\xaa\x3d\x95\xe5\x0b\x04\xa5\x92\x21\x11\x8d\xa1\xe0\xaa\xc9\x25\x72\xbe\xa7\x50\xdb\x3d\x7e\xae\x97\x65\xeb\xfd\xa7\x11\x0f\xc4\xe7\xd7\xa3\x1a\x30\x18\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04\x04\x03\x02\x05\xe0\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x03\x48\x00\x30\x45\x02\x21\x00\xdd\x11\x2f\x54\x4c\x86\x99\x20\x5f\xb1\x2e\x35\xa0\x70\x65\xfb\x91\x6d\x6e\x95\x44\x5f\x88\x70\xde\x27\xad\x14\x67\xae\xab\xf4\x02\x20\x1b\x02\x35\x79\x65\x88\x6b\xdb\xcf\x24\x07\xad\x1c\x42\xbc\x8d\x4f\xe9\xd6\x86\xc0\x64\xae\xa5\x2d\xc3\x1f\x1c\xa9\x31\x73\x6b\x00\x01\xf7\x30\x82\x01\xf3\x30\x82\x01\x98\xa0\x03\x02\x01\x02\x02\x14\x53\x26\xcc\xff\xbb\x03\xba\x78\xb8\x31\x59\x9d\xa3\xe0\x85\x13\x3d\xe8\x3d\xa8\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x30\x68\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x11\x30\x0f\x06\x03\x55\x04\x03\x0c\x08\x73\x6d\x32\x5f\x72\x6f\x6f\x74\x30\x1e\x17\x0d\x32\x30\x30\x37\x30\x32\x30\x36\x30\x30\x30\x35\x5a\x17\x0d\x33\x30\x30\x36\x33\x30\x30\x36\x30\x30\x30\x35\x5a\x30\x6e\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x17\x30\x15\x06\x03\x55\x04\x03\x0c\x0e\x73\x6d\x32\x5f\x73\x65\x72\x76\x65\x72\x5f\x65\x6e\x63\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x08\x2a\x81\x1c\xcf\x55\x01\x82\x2d\x03\x42\x00\x04\x99\xfe\x11\xaf\x63\xe5\xcc\x35\x27\x59\x77\x10\x30\xcf\x5a\xb5\x49\xf4\xf2\xee\x3c\xcd\x81\x26\x34\x5d\x81\xd0\x11\x6a\xa1\x50\x87\x97\x7e\x93\x03\x70\x1c\xc5\x65\xec\xae\x91\x44\x1b\x67\x0a\xf2\x88\xea\xde\x4c\x57\x9e\xf8\x17\xf2\xad\x65\xd0\x54\xfd\xa2\xa3\x1a\x30\x18\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04\x04\x03\x02\x04\x70\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x03\x49\x00\x30\x46\x02\x21\x00\xfb\x2c\xfe\x11\xbd\xac\xf9\x2a\x9f\x2b\x10\xbf\xdb\x9e\x6d\x7f\xff\x08\xe8\x68\x3e\xe6\x3b\x44\x0b\x25\xc5\xc6\x83\x6f\x85\xc5\x02\x21\x00\xb6\x6a\x71\xe1\x23\x6d\xe7\x53\x83\x97\x6a\x5e\x8d\x38\xf0\x6f\x0d\xb1\x45\xae\x01\xea\x83\x13\x23\x1e\xdf\xe3\x5f\x21\x56\x39\x0c\x00\x00\x4a\x00\x48\x30\x46\x02\x21\x00\xd1\x11\x93\x3a\x5d\x9b\x42\xe7\x01\x0e\x87\x87\xdc\xc6\xc2\x8e\xda\x4e\x85\x3f\xde\x9b\x0a\x27\xf8\xaa\x59\x37\xd0\x91\xaf\xdc\x02\x21\x00\x8d\xd8\x8b\x51\x16\x73\x89\x35\xce\xfa\xd8\xb5\xcd\x7a\x5f\x7b\x55\x4b\xa9\x2c\xd2\x0d\x22\xe7\x22\xa0\x55\xf4\xfc\x2e\x4d\x61\x0d\x00\x00\x05\x02\x01\x02\x00\x00\x0e\x00\x00\x00\x0b\x00\x03\xf1\x00\x03\xee\x00\x01\xf2\x30\x82\x01\xee\x30\x82\x01\x94\xa0\x03\x02\x01\x02\x02\x14\x53\x26\xcc\xff\xbb\x03\xba\x78\xb8\x31\x59\x9d\xa3\xe0\x85\x13\x3d\xe8\x3d\xa5\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x30\x68\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x11\x30\x0f\x06\x03\x55\x04\x03\x0c\x08\x73\x6d\x32\x5f\x72\x6f\x6f\x74\x30\x1e\x17\x0d\x32\x30\x30\x37\x30\x32\x30\x36\x30\x30\x30\x35\x5a\x17\x0d\x33\x30\x30\x36\x33\x30\x30\x36\x30\x30\x30\x35\x5a\x30\x6a\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x13\x30\x11\x06\x03\x55\x04\x03\x0c\x0a\x73\x6d\x32\x5f\x63\x6c\x69\x65\x6e\x74\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x08\x2a\x81\x1c\xcf\x55\x01\x82\x2d\x03\x42\x00\x04\xf1\x35\x1c\xf6\x29\x2f\x6f\x4c\xa4\xa4\xb7\x27\xd8\x1a\x32\x85\x82\x6c\xe2\x31\xc1\x69\xbb\xb3\x01\xb5\x52\x99\x1d\xe5\xd0\x16\xfe\x55\x2e\xc2\x6a\xef\x82\x60\xca\x85\xf2\x00\x7b\x9a\xb8\x36\xbe\x6a\x61\xed\xf3\xd9\xc8\x56\x7d\xcc\xe1\xd1\x39\x4d\xcf\xa9\xa3\x1a\x30\x18\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04\x04\x03\x02\x05\xe0\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x03\x48\x00\x30\x45\x02\x21\x00\xb8\xb4\xf9\x6c\x86\x44\xb8\xc8\xeb\xae\x6c\xd3\x33\xec\xc5\xdf\x78\x3e\xd7\x41\x9b\xf4\x6a\xd9\x2e\x51\xe7\x25\x7d\x25\x67\x0b\x02\x20\x29\x4d\xb4\xed\x04\xfe\xeb\xee\xc4\x7f\x95\x04\x8c\x4d\x2c\x13\x78\x1f\x1a\xc9\x30\xe3\x75\x6a\x6d\x80\x76\xff\xc1\x35\x2e\xc8\x00\x01\xf6\x30\x82\x01\xf2\x30\x82\x01\x98\xa0\x03\x02\x01\x02\x02\x14\x53\x26\xcc\xff\xbb\x03\xba\x78\xb8\x31\x59\x9d\xa3\xe0\x85\x13\x3d\xe8\x3d\xa6\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x30\x68\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x11\x30\x0f\x06\x03\x55\x04\x03\x0c\x08\x73\x6d\x32\x5f\x72\x6f\x6f\x74\x30\x1e\x17\x0d\x32\x30\x30\x37\x30\x32\x30\x36\x30\x30\x30\x35\x5a\x17\x0d\x33\x30\x30\x36\x33\x30\x30\x36\x30\x30\x30\x35\x5a\x30\x6e\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x43\x4e\x31\x11\x30\x0f\x06\x03\x55\x04\x08\x0c\x08\x53\x68\x61\x6e\x64\x6f\x6e\x67\x31\x0f\x30\x0d\x06\x03\x55\x04\x0a\x0c\x06\x53\x61\x6e\x73\x65\x63\x31\x22\x30\x20\x06\x09\x2a\x86\x48\x86\xf7\x0d\x01\x09\x01\x16\x13\x6e\x65\x69\x67\x68\x62\x61\x64\x73\x40\x67\x6d\x61\x69\x6c\x2e\x63\x6f\x6d\x31\x17\x30\x15\x06\x03\x55\x04\x03\x0c\x0e\x73\x6d\x32\x5f\x63\x6c\x69\x65\x6e\x74\x5f\x65\x6e\x63\x30\x59\x30\x13\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x08\x2a\x81\x1c\xcf\x55\x01\x82\x2d\x03\x42\x00\x04\x49\xbb\x9e\xef\xc8\x83\x18\x83\x17\x31\x96\xe6\xc9\xde\x37\xfe\xfc\x24\x25\x14\x29\xf3\xbd\x59\x50\xa1\x1f\x60\xfb\xf0\x16\xb5\x73\xbb\xec\xe3\xce\x92\xc6\x24\xb2\x1c\xb5\x70\xfb\x55\xfe\x5b\x1c\x1e\x74\xcc\xeb\xe8\x71\xff\x7d\x45\x03\x12\x8d\xa4\xef\x7e\xa3\x1a\x30\x18\x30\x09\x06\x03\x55\x1d\x13\x04\x02\x30\x00\x30\x0b\x06\x03\x55\x1d\x0f\x04\x04\x03\x02\x04\x70\x30\x0a\x06\x08\x2a\x81\x1c\xcf\x55\x01\x83\x75\x03\x48\x00\x30\x45\x02\x21\x00\xdd\xef\x00\x28\xf0\xe5\x3d\xd0\x9b\x7d\x32\xb9\x34\x26\x04\x5d\xef\x0b\x75\x24\x72\x5c\xe0\x25\x95\x8c\x96\xe9\xa6\x17\xa1\x67\x02\x20\x15\xe3\x0a\x92\x69\xfa\x4e\xec\xef\x99\x1a\x19\x35\x83\x7a\xbf\xe4\x7a\x69\x70\xf9\x58\x29\xad\x9c\xc5\x18\x13\x39\x97\xd8\x3c\x10\x00\x00\x9e\x00\x9c\x30\x81\x99\x02\x21\x00\x82\x72\x6f\x63\x4e\x53\xe6\xc5\x48\x84\xef\x29\xae\x66\x8e\x6d\xd5\x4e\xe9\xe3\x2e\x7a\xaf\xe5\xb2\xfb\x15\xdd\xf5\xaa\xdd\x45\x02\x20\x6f\x3b\x2e\x27\x71\x6e\xa9\x2f\x4d\x68\xb4\x8d\xe9\x64\x5d\xc9\x49\xbf\xa5\xda\x75\x7a\x0b\x15\xf4\x22\x62\xef\x17\xc0\x85\xb3\x04\x20\xaf\x9d\xa5\x25\x7e\xd2\x7b\x58\x65\x87\x42\x5d\xc7\x55\xb7\x88\x6b\xdf\x55\xd0\x86\x6d\xa2\x2f\x56\xc1\x7d\x8e\x7f\x14\x68\x74\x04\x30\x07\x19\x4c\xe4\x33\x55\x92\xc2\xa6\x74\xce\x3f\x15\x91\x4a\x2e\xa0\x4f\x5c\x64\xdd\xf2\x5b\x79\x6a\x4c\xb7\xdf\x12\x78\xb4\x13\xe3\x1c\x02\x66\x25\x54\x63\xb7\x41\xdd\xdf\x83\x41\x88\x19\x5a" > data.txt
~~~

~~~
$ gmssl sm3 -hex -in data.txt
c08d85599e2172797add1a3d510b63f3122815b9716e426facd0ca83a36c60cf
$ echo -e -n "\xc0\x8d\x85\x59\x9e\x21\x72\x79\x7a\xdd\x1a\x3d\x51\x0b\x63\xf3\x12\x28\x15\xb9\x71\x6e\x42\x6f\xac\xd0\xca\x83\xa3\x6c\x60\xcf" > sm3data.txt
~~~
同理得到密钥
~~~ shell
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE8TUc9ikvb0ykpLcn2BoyhYJs4jHB
abuzAbVSmR3l0Bb+VS7Cau+CYMqF8gB7mrg2vmph7fPZyFZ9zOHROU3PqQ==
-----END PUBLIC KEY-----
~~~

~~~ shell
$ echo -e -n "\x30\x45\x02\x21\x00\xb2\xe2\xc9\x24\xd4\x3a\xaa\x5a\xe1\x14\x92\xe3\x4b\x0c\x3c\xb1\xcf\xbd\x4c\x17\x42\xb3\xee\xad\x44\xa8\x9e\x71\x29\x42\x7a\x06\x02\x20\x65\x2a\x45\x50\xb0\xbd\x8f\x15\x94\xc5\xbc\x7c\x8f\x37\x05\x39\xfe\x6a\x57\xd5\xe1\xa1\x7e\x78\xff\x99\xe0\x56\x6a\x1a\x4a\x20" > client.sig
~~~

#### 验证

~~~ shell
$ gmssl sm2verify -pubkey sm3pub.pem -sig client.sig -in sm3data.txt
verify : success
~~~

### 密钥计算验证

私钥如下

~~~ 
-----BEGIN SM2 PARAMETERS-----
BggqgRzPVQGCLQ==
-----END SM2 PARAMETERS-----
-----BEGIN PRIVATE KEY-----
MIGTAgEAMBMGByqGSM49AgEGCCqBHM9VAYItBHkwdwIBAQQgb8tUl8wJ17FqiOSp
pHwKa1pOgxQhAP0VoPe/EU0cGAqgCgYIKoEcz1UBgi2hRANCAARipb11eBDLluL8
OMWZOfdyOXKsvWMu40pEW2nFdUPxWpRw+akHNz8Aat6Mbr5k9fUiG3gbC/SYG44t
d40YCWFb
-----END PRIVATE KEY-----
~~~

提取公钥

~~~
$ openssl pkey -in pri.pem -pubout -out pubkey.pem
$ cat pubkey.pem
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEYqW9dXgQy5bi/DjFmTn3cjlyrL1j
LuNKRFtpxXVD8VqUcPmpBzc/AGrejG6+ZPX1Iht4Gwv0mBuOLXeNGAlhWw==
-----END PUBLIC KEY-----
~~~

base64解密得到

~~~
30 59 30 13 06 07 2a 86 48 ce 3d 02 01 06 08 2a 81 1c cf 55 01 82 2d 03 42 00 04 62 a5 bd 75 78 10 cb 96 e2 fc 38 c5 99 39 f7 72 39 72 ac bd 63 2e e3 4a 44 5b 69 c5 75 43 f1 5a 94 70 f9 a9 07 37 3f 00 6a de 8c 6e be 64 f5 f5 22 1b 78 1b 0b f4 98 1b 8e 2d 77 8d 18 09 61 5b
~~~

即密钥为

~~~
62A5BD757810CB96E2FC38C59939F7723972ACBD632EE34A445B69C57543F15A9470F9A907373F006ADE8C6EBE64F5F5221B781B0BF4981B8E2D778D1809615B
~~~

预主密钥密文为：

~~~shell
$ echo -n -e "\x30\x81\x98\x02\x20\x2f\x12\x33\x58\x2f\x93\x18\x90\xb0\xd6\x47\x2d\x39\xc1\x72\x9c\xc2\x0e\x00\xd9\xb2\x6a\x0a\xd1\x19\xc4\x68\xb8\xbb\xbb\x3e\x1a\x02\x20\x17\x12\x74\xbf\x57\xef\x07\x1e\x4d\x76\xee\x34\x41\xf3\x9b\x31\x99\x6b\x24\x38\xe5\xf3\x33\x4f\x91\x53\x3e\x93\xaa\x1c\x3d\xb9\x04\x20\xa1\xe8\xb8\x72\x1d\x5f\x92\x2c\x6e\x33\xfb\x70\x52\xa2\xaf\xb0\x03\x8d\x05\x01\x7e\x2c\x0a\xb5\x03\x5b\xf7\x72\xda\x2c\xc2\xf3\x04\x30\xc2\xce\x0c\x66\x34\xf3\xd7\x62\x6d\xb0\x39\x63\xd8\xc1\x9d\x8a\x98\xc1\xc4\x75\x66\x59\xb7\x07\x54\x7f\xdf\x04\x39\x50\x5e\x4c\x1b\xca\x72\x40\x6c\x22\xd6\xee\x62\xe1\x81\x1d\x01\x6b\x40\x2e" > key2.bin
~~~

解密得到：

~~~shell
$ openssl pkeyutl -decrypt -inkey pri.pem -in key2.bin -out key2.txt
$ od -tx1 key2.txt
0000000 01 01 ac 14 a3 d2 da 7d cc fc aa 9f ee 08 82 f4
0000020 1b 99 74 aa 17 b8 a3 07 0c 04 2d f5 0a 27 5c aa
0000040 ec 6e d7 30 df d1 32 ea 87 1b dd 19 57 4d c8 3f
0000060
~~~

~~~ python
import hmac
key = b"\x01\x01\xac\x14\xa3\xd2\xda\x7d\xcc\xfc\xaa\x9f\xee\x08\x82\xf4\x1b\x99\x74\xaa\x17\xb8\xa3\x07\x0c\x04\x2d\xf5\x0a\x27\x5c\xaa\xec\x6e\xd7\x30\xdf\xd1\x32\xea\x87\x1b\xdd\x19\x57\x4d\xc8\x3f"
data = b"\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x74\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68"
hmac_value = hmac.new(key, data, digestmod="sm3").hexdigest()
print(hmac_value)
~~~

使用python代码计算hmac

以下仅记录key和data以及计算的hmac结果

~~~
A1：75466ba297baa6abf75fa19698b5debdf815d632b98fdaf7c1bf60d8a7724f9e
~~~

~~~
data = b"\x75\x46\x6b\xa2\x97\xba\xa6\xab\xf7\x5f\xa1\x96\x98\xb5\xde\xbd\xf8\x15\xd6\x32\xb9\x8f\xda\xf7\xc1\xbf\x60\xd8\xa7\x72\x4f\x9e"
A2：c7642fabae939cad31063af385648bb48b8fb31e4c94ed97e1cc271208c0e477
~~~

~~~
data = b"\x75\x46\x6b\xa2\x97\xba\xa6\xab\xf7\x5f\xa1\x96\x98\xb5\xde\xbd\xf8\x15\xd6\x32\xb9\x8f\xda\xf7\xc1\xbf\x60\xd8\xa7\x72\x4f\x9e\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x74\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68"
msg1:640da76978a5efd6e0953088f015fa20ee810e48e24aa6f19a8900bcff05a3a7
~~~

~~~
data = b"\xc7\x64\x2f\xab\xae\x93\x9c\xad\x31\x06\x3a\xf3\x85\x64\x8b\xb4\x8b\x8f\xb3\x1e\x4c\x94\xed\x97\xe1\xcc\x27\x12\x08\xc0\xe4\x77\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x74\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68"
msg2:722de36c807e5c7ca912e7e6ffa4965e7db07bef99df8c0f27f29c21237f94c7
~~~
以下计算工作密钥key为

~~~
key=b"\x64\x0d\xa7\x69\x78\xa5\xef\xd6\xe0\x95\x30\x88\xf0\x15\xfa\x20\xee\x81\x0e\x48\xe2\x4a\xa6\xf1\x9a\x89\x00\xbc\xff\x05\xa3\xa7\x72\x2d\xe3\x6c\x80\x7e\x5c\x7c\xa9\x12\xe7\xe6\xff\xa4\X96\X5e"
~~~

~~~
data = b"\x6b\x65\x79\x20\x65\x78\x70\x61\x6e\x73\x69\x6f\x6e\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8"
A1:6003a5937faa6c9276656bd9cf11e5fc44d1da8cf8916cc3f1a1d9c9c5b2c364
~~~

~~~
data = b"\x60\x03\xa5\x93\x7f\xaa\x6c\x92\x76\x65\x6b\xd9\xcf\x11\xe5\xfc\x44\xd1\xda\x8c\xf8\x91\x6c\xc3\xf1\xa1\xd9\xc9\xc5\xb2\xc3\x64\x6b\x65\x79\x20\x65\x78\x70\x61\x6e\x73\x69\x6f\x6e\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8"
kb1:87e00935dc21b9d87e3e5616179307d817966079a0dea9b9d09a4883cbf0e13d
~~~

~~~
data = b"\x0a\x45\x32\x8c\x9d\x23\xa8\x8a\xd0\xb0\xdf\xe3\x65\x69\x96\xb9\x79\xbd\x4a\x27\x30\xa3\xf8\xed\xe2\x9b\xc3\x92\x15\x3b\x6a\x6b"
A2:0a45328c9d23a88ad0b0dfe3656996b979bd4a2730a3f8ede29bc392153b6ab6
~~~

~~~
data = b"\x0a\x45\x32\x8c\x9d\x23\xa8\x8a\xd0\xb0\xdf\xe3\x65\x69\x96\xb9\x79\xbd\x4a\x27\x30\xa3\xf8\xed\xe2\x9b\xc3\x92\x15\x3b\x6a\x6b\x6b\x65\x79\x20\x65\x78\x70\x61\x6e\x73\x69\x6f\x6e\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8"
kb2:b4b53c3b2acafe5781712816c1a3a2cece09d5837eb3389bdf1e471b06bc8157
~~~

~~~
data = b"\x0a\x45\x32\x8c\x9d\x23\xa8\x8a\xd0\xb0\xdf\xe3\x65\x69\x96\xb9\x79\xbd\x4a\x27\x30\xa3\xf8\xed\xe2\x9b\xc3\x92\x15\x3b\x6a\x6b"
A3:fee4db5e22a5e48c3c0e0b88509763940a8e65c4aaf850c00ae7eb72282089cf
~~~

~~~
data = b"\xfe\xe4\xdb\x5e\x22\xa5\xe4\x8c\x3c\x0e\x0b\x88\x50\x97\x63\x94\x0a\x8e\x65\xc4\xaa\xf8\x50\xc0\x0a\xe7\xeb\x72\x28\x20\x89\xcf\x6b\x65\x79\x20\x65\x78\x70\x61\x6e\x73\x69\x6f\x6e\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8"
kb3:022a23065301de9e49aaa0879e4ecbf2622cda5b8994a0bb4496f03b8c13a4cd
~~~

~~~
data = b"\xfe\xe4\xdb\x5e\x22\xa5\xe4\x8c\x3c\x0e\x0b\x88\x50\x97\x63\x94\x0a\x8e\x65\xc4\xaa\xf8\x50\xc0\x0a\xe7\xeb\x72\x28\x20\x89\xcf"
A4：8807466c968862f58c17b171b3520ab2a519d5df00c8fc991e9d696244c95437
~~~

~~~
data = b"\x88\x07\x46\x6c\x96\x88\x62\xf5\x8c\x17\xb1\x71\xb3\x52\x0a\xb2\xa5\x19\xd5\xdf\x00\xc8\xfc\x99\x1e\x9d\x69\x62\x44\xc9\x54\x37\x6b\x65\x79\x20\x65\x78\x70\x61\x6e\x73\x69\x6f\x6e\x54\x23\x00\x3b\xf0\xb7\x9c\x2a\x13\x48\x37\xd6\xc5\x60\xdf\xb6\xd1\x1c\xeb\xdb\x2a\xb8\x4e\x70\x1f\xaf\xe3\x87\xb3\x1a\xc2\x68\x0a\x35\x97\x75\xd8\xa2\xc2\xfd\x27\x56\x26\x1b\x8a\xe8\x67\x67\xdb\x7b\x3c\xd3\xbe\x53\x2c\x96\x65\xea\x43\x2d\xc2\x60\xb6\xd8"
kb4：145ba093616e5939aae6b59e4bed770145482c297f4c7cc76b497fcb1b2f4a84
~~~

